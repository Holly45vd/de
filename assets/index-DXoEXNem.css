@import"https://fonts.googleapis.com/css2?family=Gaegu&family=Hi+Melody&family=Orbit&display=swap";.react-calendar,.react-calendar *,.react-calendar div,.react-calendar__viewContainer,.react-calendar__month-view,.react-calendar__navigation{background-color:#e8e1d6!important;box-shadow:none!important;border:none!important}.react-calendar__tile,.react-calendar__month-view__days,.react-calendar__month-view__weekdays{background:transparent!important}.react-calendar__month-view__weekdays__weekday{color:#4a4a4a!important;font-weight:700;padding:6px 0}.react-calendar__tile{color:#333!important;border-radius:8px!important;transition:.2s ease;padding:10px 0!important}.react-calendar__tile:hover{background:#ff6b6b14!important;color:#333!important;cursor:pointer}.react-calendar__tile.today-highlight{background-color:var(--color-primary, #FF6B6B)!important;color:#fff!important;font-weight:700;border-radius:8px}.react-calendar__tile.today-highlight:hover{background-color:#e85757!important}// src/pages/CalendarPage.jsx import React,{useEffect,useState}from "react"; import{Box,Typography,Card,CardContent,Button,useMediaQuery,}from "@mui/material"; import{useTheme,alpha}from "@mui/material/styles"; import Calendar from "react-calendar"; import "../styles/calendar.css"; import "react-calendar/dist/Calendar.css"; import dayjs from "dayjs"; import{collection,query,where,getDocs}from "firebase/firestore"; import{db}from "../firebase/firebaseConfig"; import{useAuth}from "../context/AuthContext"; import{moodIcons}from "../context/moodIcons"; import{useNavigate}from "react-router-dom"; import EditNoteIcon from "@mui/icons-material/EditNote"; import{toSafeDate}from "../utils/firebaseHelpers"; export default function CalendarPage(){const theme = useTheme();const{currentUser}= useAuth();const navigate = useNavigate();const isMobile = useMediaQuery("(max-width:768px)");const [diaries,setDiaries] = useState([]);const [diariesByDate,setDiariesByDate] = useState({});const [selectedDate,setSelectedDate] = useState(dayjs().format("YYYY-MM-DD"));const [selectedDiaries,setSelectedDiaries] = useState([]);useEffect(() => {const fetchDiaries = async () => {if (!currentUser?.uid) return; try {const q = query(collection(db,"diaries"),where("userId","==",currentUser.uid)); const snap = await getDocs(q); const all = []; const byDate = {}; snap.docs.forEach((docSnap) => {const data = docSnap.data(); const safeDate = toSafeDate(data.date); const diary = {id: docSnap.id,...data,date: safeDate,// JS Date | null}; all.push(diary); if (safeDate) {const dateKey = dayjs(safeDate).format("YYYY-MM-DD"); // 같은 날 여러 개면 마지막 mood만 쓰던 로직 유지 (원하면 배열로 확장 가능) if (!byDate[dateKey]) byDate[dateKey] = data.mood;}}); setDiaries(all); setDiariesByDate(byDate); // 오늘 날짜 초기값 const todayKey = dayjs().format("YYYY-MM-DD"); setSelectedDate(todayKey); setSelectedDiaries(all.filter((d) => d.date && dayjs(d.date).format("YYYY-MM-DD") === todayKey));} catch (error) {console.error("캘린더 데이터 불러오기 오류:",error);}}; fetchDiaries();},[currentUser]);const handleDateClick = (date) =>{const dateKey = dayjs(date).format("YYYY-MM-DD");setSelectedDate(dateKey);setSelectedDiaries(diaries.filter((d) => d.date && dayjs(d.date).format("YYYY-MM-DD") === dateKey))}const renderTileContent = ({date,view}) =>{if (view !== "month") return null;const dateKey = dayjs(date).format("YYYY-MM-DD");const moodKey = diariesByDate[dateKey];return (<div style={{textAlign: "center",marginTop: "2px"}}> {moodKey ? (<img src={moodIcons[moodKey]?.color} alt={moodIcons[moodKey]?.ko || moodKey} style={{width: isMobile ? 30 : 60,height: isMobile ? 26 : 54,margin: "0 auto",display: "block",transition: "transform 0.2s",}} />) : (<span style={{fontSize: isMobile ? "0.7rem" : "0.9rem",color: "inherit",}} > {dayjs(date).date()} </span>)} </div>)}const handleCardClick = (id) => navigate(`/diary/${id}`);const primary = theme.palette.primary.main;return (<Box sx={{p: 3,maxWidth: isMobile ? 420 : 960,mx: "auto",textAlign: "center",}} > <Typography variant="h5" mb={3} sx={{fontWeight: 800,color: "primary.main"}} > 캘린더 </Typography> {} <Box sx={{mb: 4,".react-calendar": {width: "100%",maxWidth: isMobile ? "380px" : "920px",fontSize: isMobile ? "0.85rem" : "1rem",borderRadius: "12px",padding: isMobile ? "6px" : "10px",border: `1px solid ${alpha(theme.palette.text.primary,.12)}`,background: theme.palette.background.paper,},".react-calendar__tile": {flex: "1 0 calc(100% / 7)",height: isMobile ? "56px" : "92px",textAlign: "center",borderRadius: "8px",padding: "5px 0",transition: "0.2s","&:hover": {backgroundColor: alpha(primary,.08)},},".react-calendar__tile--active": {backgroundColor: primary,color: theme.palette.getContrastText(primary),},}} > <Calendar locale="ko" value={dayjs(selectedDate).toDate()} onClickDay={handleDateClick} tileContent={renderTileContent} formatDay={() => ""} // 기본 날짜 숫자는 타일 콘텐츠로 대체 /> </Box> {} <Box sx={{mt: 4}}> {selectedDiaries.length > 0 ? (selectedDiaries.map((diary) => (<Card key={diary.id} onClick={() => handleCardClick(diary.id)} sx={{mb: 2,cursor: "pointer",borderRadius: 2,boxShadow: 1,"&:hover": {boxShadow: 4,backgroundColor: alpha(primary,.04)},}} > <CardContent> <Box display="flex" alignItems="center" justifyContent="space-between" sx={{width: "100%"}} > {} <Box display="flex" alignItems="center" gap={1.5} sx={{flex: 1}}> <img src={moodIcons[diary.mood]?.color} alt={moodIcons[diary.mood]?.ko || diary.mood} style={{width: 30,height: 30}} /> <Typography variant="body1" sx={{flexGrow: 1,textAlign: "left",overflow: "hidden",whiteSpace: "nowrap",textOverflow: "ellipsis",}} > {diary.content || ""} </Typography> </Box> {} <Typography variant="body2" sx={{minWidth: "64px",textAlign: "center",color: "text.secondary",fontWeight: 700,}} > {diary.date ? dayjs(diary.date).format("MM-DD") : "-"} </Typography> </Box> </CardContent> </Card>))) : (<Box sx={{mt: 3,textAlign: "center"}}> <Typography sx={{mb: 2}}> {selectedDate === dayjs().format("YYYY-MM-DD") ? "오늘 작성된 일기가 없습니다." : "이 날짜에는 작성된 일기가 없습니다."} </Typography> <Button variant="contained" color="primary" startIcon={<EditNoteIcon />} onClick={() => navigate(`/editor?date=${selectedDate}`)} > 새 일기 쓰기 </Button> </Box>)} </Box> </Box>)}.react-calendar__navigation button{background:transparent!important;color:#2d3142!important;font-size:1rem;font-weight:700}.react-calendar__navigation button:hover{background:#00000012!important;border-radius:6px}.calendar-wrapper{background-color:#e8e1d6!important;padding:12px;border-radius:16px;box-shadow:0 2px 6px #00000014}.react-calendar{width:350px;max-width:100%;background:#fff;border:1px solid #a0a096;font-family:Arial,Helvetica,sans-serif;line-height:1.125em}.react-calendar--doubleView{width:700px}.react-calendar--doubleView .react-calendar__viewContainer{display:flex;margin:-.5em}.react-calendar--doubleView .react-calendar__viewContainer>*{width:50%;margin:.5em}.react-calendar,.react-calendar *,.react-calendar *:before,.react-calendar *:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.react-calendar button{margin:0;border:0;outline:none}.react-calendar button:enabled:hover{cursor:pointer}.react-calendar__navigation{display:flex;height:44px;margin-bottom:1em}.react-calendar__navigation button{min-width:44px;background:none}.react-calendar__navigation button:disabled{background-color:#f0f0f0}.react-calendar__navigation button:enabled:hover,.react-calendar__navigation button:enabled:focus{background-color:#e6e6e6}.react-calendar__month-view__weekdays{text-align:center;text-transform:uppercase;font:inherit;font-size:.75em;font-weight:700}.react-calendar__month-view__weekdays__weekday{padding:.5em}.react-calendar__month-view__weekNumbers .react-calendar__tile{display:flex;align-items:center;justify-content:center;font:inherit;font-size:.75em;font-weight:700}.react-calendar__month-view__days__day--weekend{color:#d10000}.react-calendar__month-view__days__day--neighboringMonth,.react-calendar__decade-view__years__year--neighboringDecade,.react-calendar__century-view__decades__decade--neighboringCentury{color:#757575}.react-calendar__year-view .react-calendar__tile,.react-calendar__decade-view .react-calendar__tile,.react-calendar__century-view .react-calendar__tile{padding:2em .5em}.react-calendar__tile{max-width:100%;padding:10px 6.6667px;background:none;text-align:center;font:inherit;font-size:.833em}.react-calendar__tile:disabled{background-color:#f0f0f0;color:#ababab}.react-calendar__month-view__days__day--neighboringMonth:disabled,.react-calendar__decade-view__years__year--neighboringDecade:disabled,.react-calendar__century-view__decades__decade--neighboringCentury:disabled{color:#cdcdcd}.react-calendar__tile:enabled:hover,.react-calendar__tile:enabled:focus{background-color:#e6e6e6}.react-calendar__tile--now{background:#ffff76}.react-calendar__tile--now:enabled:hover,.react-calendar__tile--now:enabled:focus{background:#ffffa9}.react-calendar__tile--hasActive{background:#76baff}.react-calendar__tile--hasActive:enabled:hover,.react-calendar__tile--hasActive:enabled:focus{background:#a9d4ff}.react-calendar__tile--active{background:#006edc;color:#fff}.react-calendar__tile--active:enabled:hover,.react-calendar__tile--active:enabled:focus{background:#1087ff}.react-calendar--selectRange .react-calendar__tile--hover{background-color:#e6e6e6}:root{--color-coral: #FF6B6B;--color-blush: #F4C2C2;--color-navy: #0A0F29;--color-burg: #8C0B1E;--color-primary: var(--color-coral);--color-primary-hover: #E85C5C;--color-bg: #ffffff;--color-text: var(--color-navy);--color-text-light: #777;--font-main: "Orbit","Hi Melody","Gaegu",sans-serif;--font-diary: "Hi Melody","Gaegu",cursive;--border-radius: 14px;--transition-speed: .3s;--focus-ring: 0 0 0 3px rgba(255,107,107,.35)}*{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-main);background-color:var(--color-bg);color:var(--color-text);line-height:1.5;font-weight:400;min-width:320px;min-height:100vh;display:flex;flex-direction:column}a{font-weight:500;color:var(--color-primary);text-decoration:none;transition:color var(--transition-speed)}a:hover{color:var(--color-primary-hover)}button:focus-visible,a:focus-visible,.btn:focus-visible{outline:none;box-shadow:var(--focus-ring);border-radius:var(--border-radius)}button,.btn{display:inline-block;padding:10px 16px;border-radius:var(--border-radius);font-size:1rem;font-weight:500;cursor:pointer;transition:background var(--transition-speed),color var(--transition-speed)}button.primary,.btn-primary{background:var(--color-primary);color:#fff;border:1px solid var(--color-primary)}button.primary:hover,.btn-primary:hover{background:var(--color-primary-hover)}button.outline,.btn-outline{background:transparent;border:1px solid var(--color-primary);color:var(--color-primary)}button.outline:hover,.btn-outline:hover{background:#ff6b6b0f;border-color:var(--color-primary-hover);color:var(--color-primary-hover)}.card{background:#fff;border:1px solid #eaeaea;border-radius:var(--border-radius);box-shadow:0 2px 8px #00000014;transition:transform var(--transition-speed),box-shadow var(--transition-speed)}.card:hover{transform:translateY(-4px);box-shadow:0 4px 12px #0000001f;background-color:#fff1f1}.diary-content{font-family:var(--font-diary);font-size:1.1rem;line-height:1.8;color:#444;white-space:pre-line}.container{width:100%;max-width:1200px;margin:0 auto;padding:16px;box-sizing:border-box}@media (max-width: 768px){body{padding:0 1rem}.container{padding:12px}}
